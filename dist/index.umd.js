!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).FormStorage=e()}(this,function(){"use strict";return class{t;i;o=null;constructor(t,e){this.t=t,this.i={name:"form",ignores:[],includes:[],checkbox:null,...e},document.addEventListener("DOMContentLoaded",()=>{this.i.checkbox&&(this.o=document.querySelector(this.i.checkbox),this.h())})}save(){window.localStorage.setItem(this.i.name,this.u())}apply(){const t=window.localStorage.getItem(this.i.name);t&&this.l(t)}clear(){window.localStorage.removeItem(this.i.name)}addEventListener(t,e,n){this.p().addEventListener(t,e,n)}addChildrenEventListener(t,e,n){this.m().forEach(s=>s.addEventListener(t,e,n))}p(){return document.querySelector(this.t)}m(){const{ignores:t,includes:e}=this.i;return[...document.querySelectorAll(`${this.t} input:not([type="file"]):not([type="password"]), select, textarea`)].filter(n=>t.every(t=>!n.matches(t))&&(0===e.length||e.some(t=>n.matches(t))))}_(){const t=new FormData(this.p()),e=this.m().map(t=>t.name);return[...t.keys()].forEach(n=>{e.includes(n)||t.delete(n)}),new URLSearchParams([...t].map(([t,e])=>[t,String(e)])).toString()}h(){this.p().addEventListener("submit",()=>{this.o?.checked?this.save():this.clear()})}u(){return this._()}l(t){const e=this.m();(function(t){const e=new URLSearchParams(t);return new Map(Array.from(e.keys()).map(t=>[t,e.getAll(t)]))})(t).forEach((t,n)=>{const s=e.filter(t=>t.matches(`[name="${n}"]`));0!==s.length&&s.forEach((e,n)=>{"checked"in e&&["checkbox","radio"].includes(e.type)?t.forEach(t=>{e.value===t&&(e.checked=!0)}):n<t.length&&(e.value=t[n])})})}}});
